
<!----------------------------------------------------------------------------------------------------------------------
-                                                                                                                      -
-    Created by: MPZinke on 2023.01.22                                                                                 -
-                                                                                                                      -
-    DESCRIPTION:                                                                                                      -
-    BUGS:                                                                                                             -
-    FUTURE:                                                                                                           -
-                                                                                                                      -
----------------------------------------------------------------------------------------------------------------------->


{% macro list_steps(listed_steps) %}
	{% for step in listed_steps %}
		<div>
			<input type="checkbox" onclick="strikethrough_text(this);" />
			<span>
				{{ step | replace_timer() }}
			</span>
		</div>
	{% endfor %}
{% endmacro %}


{% extends "header.j2" %}
{% block body %}
	<title>
		{{ recipe.name() }}
	</title>
	<h1>
		{{ recipe.name() }}
	</h1>
	<table>
		<tr>
			<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
				Rating:
				{% for _ in range(recipe.rating()) %}
					✭
				{% endfor %}
				{% for _ in range(recipe.rating(), 5)  %}
					✩
				{% endfor %}
			</td>
			<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
				Serving Size:
				{{ recipe.serving_size() }}
			</td>
			<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
				<!-- This is here to add a right closing border -->
			</td>
		</tr>
		<tr>
			{% if recipe.total_time().total_seconds() != 0 %}
				<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
					Total Time:
					{{ recipe.total_time() }}
				</td>
			{% endif %}
			{% if recipe.prep_time().total_seconds() != 0 %}
				<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
					Prep Time:
					{{ recipe.prep_time() }}
				</td>
			{% endif %}
			{% if recipe.cook_time().total_seconds() != 0 %}
				<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
					Cook Time:
					{{ recipe.cook_time() }}
				</td>
			{% endif %}
			<td style="border-left: 1px solid #cdd0d4; padding-left: 8px; padding-right: 8px;">
				<!-- This is here to add a right closing border -->
			</td>
		</tr>
	</table>
	<p>
		{{ recipe.notes() }}
	</p>
	<h2>
		Ingredients
	</h2>
	<table>
		{% for ingredient in recipe.ingredients() %}
			<tr>
				<td>
					{% if ingredient.amount() != 0.0 %}
						{{ (ingredient.amount()) | format_decimal() }}
					{% endif %}
					{{ ingredient.unit(ingredient.amount()) }}
					{{ ingredient.quality() }}
					<a href="/ingredient/{{ ingredient.name() }}">{{ ingredient.name() }}</a>
					{% if ingredient.notes() != "" %}
						—
						<i>
							{{ ingredient.notes() }}
						</i>
					{% endif %}
					{% if ingredient.is_required() == False %}
						<b>
						OPTIONAL
						</b>
					{% endif %}
				</td>
			</tr>
		{% endfor %}
	</table>
	<h2>
		Instructions
	</h2>
	{% with instructions = recipe.instructions() %}
		{% if instructions.__class__.__name__ == "list" %}
			{{ list_steps(instructions) }}
		{% elif instructions.__class__.__name__ == "dict" %}
			{% for section, steps in instructions.items() %}
				<h3>
					{{ section }}
				</h3>
				{{ list_steps(steps) }}
			{% endfor %}
		{% endif %}
	{% endwith %}

	<script>
		function strikethrough_text(element)
		{
			const instruction_div = element.parentElement;
			if(instruction_div.style.color != "var(--disabled-text-color)")
			{
				instruction_div.style.color = "var(--disabled-text-color)";
			}
			else
			{
				instruction_div.style.color = "var(--text-color)";
			}
		}
	</script>
{% endblock %}