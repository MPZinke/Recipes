
<!----------------------------------------------------------------------------------------------------------------------
-                                                                                                                      -
-    Created by: MPZinke on 2023.02.05                                                                                 -
-                                                                                                                      -
-    DESCRIPTION:                                                                                                      -
-    BUGS:                                                                                                             -
-    FUTURE:                                                                                                           -
-                                                                                                                      -
----------------------------------------------------------------------------------------------------------------------->


{% extends "Header.j2" %}
{% block body %}
	<script>
		var Recipe = {};  // Initialize namespace `Recipe`
	</script>

	<input
	  id="Recipe-new_Recipe_json-div"
	  name="Recipe-new_Recipe_json-div"
	  hidden
	/>

	<form>
		{% include("New/Recipe/Name.j2") %}
		{% include("New/Recipe/Servings.j2") %}
		{% include("New/Recipe/Rating.j2") %}
		{% include("New/Recipe/PrepTime.j2") %}
		{% include("New/Recipe/CookTime.j2") %}
		{% include("New/Recipe/TotalTime.j2") %}
		{% include("New/Recipe/Notes.j2") %}
	</form>

	{% include("New/Recipe/Instructions/Index.j2") %}
	{% include("New/Recipe/RecipeIngredients/Index.j2") %}

<script>
	Recipe.NEW_RECIPE = {RecipeIngredients: []};


	Recipe.update_json =
	function update_json(value, ...keys)
	{
		let current_value = NEW_RECIPE;
		for(let x = 0; x < keys.length-1; x++)
		{
			current_value = current_value[keys];
		}

		if(current_value[keys[keys.length-1]] !== undefined && Array.isArray(current_value[keys[keys.length-1]]))
		{
			current_value[keys[keys.length-1]].push(value);
		}
		else
		{
			current_value[keys[keys.length-1]] = value;
		}

		console.log(NEW_RECIPE);  // TESTING
		Recipe.NEW_RECIPE_JSON_DIV.value = JSON.stringify(NEW_RECIPE);
	};


	Recipe.uuid4 =
	function uuid4()
	{
		return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
			function(c)
			{
				const r = Math.random() * 16 | 0;
				const v = c === 'x' ? r : (r & 0x3 | 0x8);
				return v.toString(16);
			}
		);
	}

</script>

{% endblock %}
